
<div class="jumbotron jumbotron-fluid">
  <div class="container">
    <h1></h1>      
    {{!-- <p>Bootstrap is the most popular HTML, CSS, and JS framework for developing responsive, mobile-first projects on the web.</p> --}}
    <br>
    <label for="db">Selecciona una base para persistir los datos - por defecto es MongoDBaaS</label>
    <select name="db" id="dbAlta" onchange="cambioBase2()">
        <option  value="fs" disabled>File System</option>
        <option  value="MySQL">MySQL</option>
        <option  value="MySQLDBaaS" disabled>MySQLDBaaS</option>
        <option value="SQLite3">SQLite3</option>
        <option value="MongoD" selected>MongoD</option>
        <option value="MongoDBaaS">MongoDBaaS</option>
        <option disabled value="Firebase">Firebase</option>
    </select> 
    <button onclick="dbAlta()">ConsoleLog Base Seleccionada</button>
  </div>
</div>

<div class="container">
    <h1 style="color: blue;">{{bienvenida}}</h1>  
    <br><br>
    <div class="container col-md-6 d-flex justify-content-center" style="border: 1px solid blue">
        <form class=" d-flex flex-column" method="" action="" id="altaForm">
            <div class="form-group">
                <label for="titleA">Title:</label>
                <input id="titleA" class="form-control" type="text" name="title"  class="ml-auto" required placeholder="title"/>
            </div>
            <div class="form-group">
                <label for="priceA">Price:</label>
                <input id="priceA" class="form-control" type="number" name="price" class="ml-auto" required placeholder="$"/>
            </div>
            <div class="form-group">
                <label for="thumbnailA">thumbnail:</label>
                <input id="thumbnailA" class="form-control" type="text" name="thumbnail" class="ml-auto" required placeholder="URL de la imagen"/>
            </div>
            <button onclick="alta()" class="btn btn-default" value="Agregar">Submit</button>
        </form>
    </div>
</div>
<script>
    var baseAlta = "MongoD"
    function cambioBase2(){
        baseAlta = document.getElementById("dbAlta").value;
        console.log(baseAlta)
    }
    const dbAlta = () =>{
        console.log(baseAlta)

    }
    function dbSelect(){
        console.log("test")
    }

    const alta = () =>{
    // if(confirm(`Caballero Agregado Correctamente`)){
    //         location.replace("/productos") 
    //     }
    //location.replace("/productos") 
    console.log("alta")
    var titleA = document.getElementById("titleA").value;
    var priceA = parseInt(document.getElementById("priceA").value);
    var thumbnailA = document.getElementById("thumbnailA").value;
    console.log(`${titleA},${priceA},${thumbnailA}`)
    fetch(`api/${baseAlta}/productos`, {
        method: 'POST',
        headers: {
        'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            "title": `${titleA}`,
            "price": parseInt(priceA),
            "thumbnail": `${thumbnailA}`
        })
    })
    .then(response => {
        return response.json()
        // if(confirm('Caballero Eliminado Correctamente')){
        //     location.replace("/productos") 
        // }
    })
    .then(data => {
        console.log(data)
        // console.log(data[Object.keys(data)[0]].title)
        if(confirm(`Item dado de alta correctamente`)){
            document.getElementById("altaForm").reset(); 
            location.replace("/alta") 
        }
    })
    .catch(error => console.log(error))
}
</script>
{{!-- <script src="index.js"></script> --}}
{{!-- DESAFIO 10 HANDLEBARS --}}
{{!-- LISTADO DE PRODUCTOS POR ID/ GET --}}
